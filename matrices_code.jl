
function days_vac_f(l::Int64)

    v = [i for i in p.day_inital_vac:(p.day_inital_vac+(l-2))]
    
    return v
end

function vaccination_rate_1(sim::Int64)
    
    if p.prov == :usa
        p.day_inital_vac = 104
        v = [0 0 0 0 0 0 0 0;
                0 0 0 1 1 2 1 1;
                0 0 0 0 0 0 0 0;
                0 0 1 5 3 4 1 0;
                0 0 2 17 11 14 3 1;
                0 0 3 29 19 24 5 1;
                0 0 5 44 28 37 7 2;
                0 0 2 20 12 15 3 1;
                0 0 1 12 7 8 2 1;
                0 0 5 39 24 33 7 4;
                0 0 6 44 29 40 9 5;
                0 0 8 54 37 52 12 7;
                0 0 3 19 12 18 4 2;
                0 0 0 1 1 1 0 0;
                0 0 2 13 9 12 3 3;
                0 0 2 9 6 8 2 2;
                0 0 8 49 34 52 15 15;
                0 0 10 57 40 63 21 20;
                0 0 12 65 46 73 26 25;
                0 0 6 33 23 36 13 12;
                0 0 1 4 3 6 5 5;
                0 0 4 17 12 19 9 15;
                0 0 2 9 6 10 5 7;
                0 0 9 42 30 48 24 27;
                0 0 10 49 35 58 31 34;
                0 0 12 54 39 64 37 42;
                0 0 12 55 39 66 41 47;
                0 0 12 56 39 64 40 45;
                0 0 5 22 15 23 22 24;
                0 0 3 10 6 10 10 13;
                0 0 9 39 28 46 39 55;
                0 0 12 49 36 58 50 70;
                0 0 13 52 38 64 61 81;
                0 0 14 56 42 69 74 94;
                0 0 14 56 41 68 71 87;
                0 0 7 25 18 30 41 50;
                0 0 3 10 7 12 21 24;
                0 0 6 23 18 32 47 65;
                0 0 10 37 28 50 72 92;
                0 0 12 42 32 57 90 112;
                0 0 13 46 35 63 108 136;
                0 0 13 50 37 67 119 135;
                0 0 7 23 18 33 69 75;
                0 0 3 9 7 13 30 30;
                0 0 7 27 21 41 76 86;
                0 0 9 32 25 49 95 107;
                0 0 10 38 29 57 116 126;
                0 0 11 42 33 63 127 139;
                0 1 12 44 34 65 128 133;
                0 0 6 21 16 32 76 78;
                0 0 3 9 7 14 34 31;
                0 0 5 21 17 35 78 75;
                0 0 7 25 21 44 100 92;
                0 0 9 34 28 57 131 121;
                0 1 10 39 31 65 146 128;
                0 0 11 42 33 66 143 118;
                0 1 7 25 19 40 91 76;
                0 0 2 8 7 13 31 24;
                0 0 6 22 18 38 94 74;
                0 0 8 28 23 49 117 89;
                0 1 9 34 28 59 137 104;
                0 1 10 36 29 63 144 103;
                0 1 10 40 32 70 163 103;
                0 1 6 24 20 45 104 63;
                0 0 2 9 8 17 44 24;
                0 0 5 16 13 30 75 48;
                0 0 6 22 18 40 95 60;
                0 1 8 26 21 47 111 70;
                0 0 6 24 19 44 100 61;
                0 1 8 29 22 49 91 53;
                0 0 6 19 16 35 68 39;
                0 0 2 9 7 16 27 17;
                0 0 5 20 16 38 72 38;
                0 0 7 26 21 52 105 56;
                0 1 10 39 33 79 144 75;
                0 1 13 50 42 101 174 90;
                0 1 16 61 50 117 178 89;
                0 1 11 42 36 84 117 56;
                0 1 6 21 17 40 55 25;
                0 1 11 43 37 88 123 57;
                0 1 14 53 45 111 149 71;
                0 1 18 66 55 140 169 79;
                0 2 22 77 64 167 181 83;
                0 2 26 89 74 186 160 73;
                0 2 18 65 53 131 97 43;
                0 1 11 36 28 65 45 20;
                0 1 20 67 56 151 105 47;
                0 2 24 83 69 186 123 58;
                0 3 30 97 82 220 131 63;
                0 3 34 110 91 255 134 65;
                0 3 34 111 91 237 113 53;
                0 2 24 76 62 155 69 31;
                0 1 13 38 30 71 28 13;
                0 3 24 79 64 179 71 33;
                0 3 33 101 83 233 88 41;
                0 4 39 115 94 260 91 42;
                0 4 43 126 103 278 97 45;
                0 5 45 130 107 262 84 39;
                0 4 28 85 70 167 50 23;
                0 2 16 45 36 79 20 9;
                0 4 33 94 80 195 53 25;
                0 5 41 118 100 240 64 30;
                0 7 49 133 113 265 68 32;
                0 7 53 141 118 268 67 32;
                0 8 53 138 111 242 59 28;
                0 7 35 93 74 158 34 15;
                0 4 18 47 37 76 14 6;
                0 7 43 112 90 172 41 20;
                0 10 57 143 112 211 51 25;
                0 13 74 177 136 242 57 28;
                0 14 78 185 141 259 57 28;
                0 14 64 157 119 205 43 20;
                0 10 41 106 78 130 23 11;
                0 4 15 38 26 39 7 3;
                0 13 60 140 95 162 35 17;
                0 17 84 186 124 210 47 23;
                0 21 102 211 138 225 51 25;
                0 21 105 213 139 221 50 25;
                0 22 102 207 134 206 44 22;
                0 20 71 149 96 143 28 13;
                0 11 37 76 48 64 12 5;
                0 16 69 138 89 133 31 15;
                0 21 76 152 95 137 30 15;
                0 24 77 150 94 134 30 15;
                0 25 79 156 98 129 29 14;
                0 26 74 147 92 119 25 12;
                0 25 51 104 66 82 16 8;
                0 12 25 49 31 36 7 3;
                0 18 49 95 60 78 18 9;
                0 23 63 122 76 99 23 11;
                0 26 63 121 76 99 23 12;
                0 23 64 122 77 102 24 12;
                0 24 60 119 76 100 21 11;
                0 25 45 88 56 71 13 6;
                0 14 23 44 27 32 6 3;
                0 16 41 81 51 69 16 8;
                0 18 48 95 60 82 20 11;
                0 21 51 98 62 84 21 11;
                0 18 49 95 60 82 21 11;
                0 19 47 96 61 82 19 10;
                0 17 30 61 39 50 11 5;
                0 7 15 29 18 23 5 2;
                0 10 28 54 34 48 13 7;
                0 12 37 70 43 60 17 9;
                0 14 37 69 42 59 17 9;
                0 12 35 66 40 57 16 9;
                0 13 35 69 42 57 15 8;
                0 10 23 44 28 36 8 4;
                0 4 10 19 11 14 3 1;
                0 7 24 41 25 35 10 5;
                0 12 32 55 33 46 14 7;
                0 21 30 51 31 43 13 7;
                3 105 30 52 31 42 12 7;
                3 118 33 64 40 52 13 7;
                3 121 25 46 29 36 8 4;
                2 62 15 26 16 19 4 2;
                2 87 32 55 33 42 12 6;
                2 92 37 63 37 48 13 7;
                3 98 36 60 36 46 13 7;
                2 83 34 59 35 45 13 7;
                2 84 33 62 37 46 12 6;
                2 81 24 44 28 32 7 3;
                1 31 13 23 14 15 3 1;
                1 45 27 45 26 33 9 4;
                1 47 28 48 27 34 10 5;
                1 53 27 45 26 32 9 5;
                1 44 26 44 25 31 9 5;
                1 44 23 44 26 32 8 4;
                1 28 15 28 17 20 4 2;
                0 13 9 16 9 10 2 1;
                0 4 4 7 4 5 1 1;
                1 34 23 39 22 28 8 4;
                1 34 21 36 21 25 7 4;
                1 32 19 34 19 24 7 4;
                1 35 19 38 21 26 7 4;
                1 29 13 25 15 17 4 2;
                0 14 7 13 8 8 2 1;
                1 26 16 27 16 19 5 3;
                1 28 17 30 16 21 6 3;
                1 27 16 29 16 20 6 3;
                1 27 17 30 17 21 6 4;
                1 28 17 33 19 23 6 3;
                1 20 11 21 13 14 3 1;
                0 6 5 10 6 6 1 1;
                1 22 15 25 14 17 5 2;
                1 23 16 27 15 18 6 3;
                1 23 16 27 15 18 5 3;
                1 22 15 26 15 18 5 3;
                1 22 15 28 16 20 5 3;
                1 15 10 18 11 13 3 1;
                0 7 5 9 5 6 1 0;
                1 19 13 22 13 16 5 2;
                1 20 14 24 14 17 5 3;
                1 20 14 24 14 18 5 3;
                1 20 14 24 14 17 5 3;
                1 21 14 27 16 20 5 3;
                1 14 9 18 11 12 3 1;
                0 8 6 10 6 6 1 1;
                1 18 12 21 12 14 4 2;
                1 18 13 22 13 16 5 2;
                1 19 14 23 13 16 5 2;
                0 18 14 21 12 16 5 3;
                0 18 13 23 14 17 5 2;
                0 10 8 14 9 10 2 1;
                0 1 1 2 2 2 0 0;
                0 12 9 16 9 11 3 1;
                0 16 13 20 12 15 5 2;
                0 17 13 21 12 15 5 2;
                0 17 13 22 12 16 5 3;
                0 18 14 25 14 18 5 3;
                0 13 9 16 10 12 3 1;
                0 8 5 9 5 6 1 0;
                0 17 13 20 12 14 4 2;
                0 18 13 21 12 14 4 2;
                0 19 13 20 12 15 5 2;
                0 19 13 22 12 16 5 3;
                0 22 14 26 15 19 5 3;
                0 14 9 17 10 13 3 1;
                0 9 6 11 6 7 2 1;
                0 22 14 24 15 19 6 3;
                0 24 16 26 16 21 6 3;
                0 24 16 28 17 22 7 3;
                0 25 16 30 18 24 7 4;
                0 28 18 37 23 29 8 4;
                0 17 11 23 15 18 4 2;
                0 12 8 16 10 11 2 1;
                0 26 18 34 20 25 7 3;
                0 28 20 36 21 27 8 4;
                0 29 20 38 22 27 8 4;
                0 30 20 38 22 27 8 4;
                0 32 22 45 27 33 9 4;
                0 20 14 28 17 19 4 2;
                0 13 9 19 11 12 2 1;
                0 30 21 39 23 27 8 4;
                0 32 21 42 24 29 8 4;
                0 33 22 44 25 29 9 4;
                0 33 22 44 25 30 9 4;
                0 36 23 51 29 35 9 4;
                0 24 14 31 18 20 4 2;
                0 14 10 20 11 12 2 1;
                0 33 21 42 23 27 7 3;
                0 32 21 43 24 27 8 4;
                0 29 20 41 22 26 7 4;
                0 29 21 43 23 27 8 4;
                0 33 22 49 27 30 8 4;
                0 24 14 30 17 18 5 2;
                0 12 9 19 10 10 3 1;
                0 23 19 39 21 24 8 4;
                0 25 21 41 22 25 9 5;
                0 23 20 42 22 25 9 5;
                0 22 20 41 22 26 9 5;
                0 28 21 45 25 29 9 5;
                0 21 12 26 15 16 4 2;
                0 10 8 16 9 9 2 1;
                0 19 19 39 21 24 8 4;
                0 19 20 41 21 25 8 5;
                0 19 20 42 22 25 8 5;
                0 19 21 42 22 26 9 5;
                0 24 23 47 25 29 9 5;
                0 20 13 26 14 16 4 2;
                0 10 9 17 9 9 2 1;
                0 17 18 38 19 22 8 4;
                0 16 19 38 19 22 8 4;
                0 16 20 39 19 22 8 4;
                0 15 19 37 18 21 7 4;
                0 22 19 40 20 24 8 4;
                0 15 10 21 11 12 3 2;
                0 9 8 15 7 8 2 1;
                0 4 4 7 4 4 1 1;
                0 13 16 33 16 18 6 4;
                0 13 18 35 16 18 7 4;
                0 13 18 35 16 19 7 4;
                0 18 20 42 21 24 7 4;
                0 14 11 23 12 13 3 2;
                0 7 7 15 7 7 2 1;
                0 11 16 33 16 18 6 3;
                0 11 15 31 14 16 6 3;
                0 11 14 30 14 16 5 3;
                0 11 15 30 14 16 5 3;
                0 14 16 34 16 18 6 3;
                0 11 9 19 9 10 3 2;
                0 5 6 11 5 5 2 1;
                0 9 12 26 12 14 5 3;
                0 8 12 26 12 13 5 3;
                0 9 11 25 11 13 5 3;
                0 8 12 24 12 13 5 3;
                0 11 13 29 14 16 9 6;
                0 9 7 16 8 10 9 5;
                0 4 4 10 5 6 6 3;
                0 7 10 24 11 14 17 11;
                0 7 10 23 11 14 15 11;
                0 7 10 23 11 14 14 10;
                0 7 10 24 12 15 14 10;
                0 9 10 26 13 17 14 9;
                0 7 6 15 7 9 6 4;
                0 4 4 10 4 5 4 2;
                0 6 8 21 10 13 12 8;
                0 6 8 20 10 13 12 8;
                0 6 9 21 10 13 12 8;
                0 6 8 21 10 14 11 8;
                0 9 9 24 12 16 11 7;
                0 6 5 12 6 8 5 3;
                0 3 4 8 4 5 3 2;
                0 6 8 19 9 12 10 7;
                0 6 8 19 9 13 10 7;
                0 5 8 20 9 13 9 7;
                0 5 8 19 10 13 9 7;
                0 8 9 23 11 16 9 6;
                0 5 6 12 6 8 4 3;
                0 3 4 8 4 5 2 1;
                0 5 8 20 10 13 9 6;
                0 5 7 17 8 12 9 6;
                0 5 7 17 8 12 8 6;
                0 5 7 17 9 13 9 7;
                0 7 8 22 12 19 17 11;
                0 4 5 12 7 12 11 7;
                0 2 3 8 4 7 7 4;
                0 4 7 20 11 19 23 15;
                0 4 8 20 11 19 22 15;
                0 5 8 21 11 19 21 15;
                0 5 7 21 11 19 20 15;
                0 6 8 24 14 24 20 13;
                0 4 4 12 7 13 10 6;
                0 2 3 8 4 8 6 3;
                0 5 7 21 11 19 18 12;
                0 5 8 20 11 19 18 13;
                7 4 8 21 11 19 17 13;
                20 5 7 20 11 19 17 12;
                35 7 9 26 15 24 16 11;
                62 5 5 14 8 13 7 5;
                35 2 3 9 5 7 4 3;
                65 5 7 19 10 17 13 9;
                75 6 7 19 11 18 15 11;
                86 7 8 20 12 19 14 11;
                84 7 7 19 11 18 13 9;
                93 8 9 24 14 23 14 9;
                102 6 5 14 8 13 7 4;
                38 3 3 9 5 8 4 2;
                53 6 8 21 12 20 14 9;
                58 6 8 21 12 21 14 10;
                60 6 8 22 12 22 14 10;
                58 6 9 23 13 23 14 10;
                69 8 10 28 16 27 13 9;
                73 6 6 16 10 17 7 4;
                22 3 4 11 6 10 4 2;
                47 6 10 25 14 24 11 7;
                49 6 11 25 13 23 11 7;
                40 6 11 21 12 19 8 5;
                0 0 0 0 0 0 0 0;
                24 4 8 18 10 18 7 4;
                20 3 5 13 7 12 4 2;
                11 2 4 9 5 8 3 1;
                25 4 8 21 12 21 10 6;
                28 5 9 23 13 23 11 7;
                30 5 10 28 15 27 12 8;
                27 5 10 28 16 26 12 8;
                32 6 11 30 18 29 11 7;
                27 4 6 16 10 16 5 3;
                10 2 4 11 6 10 3 2;
                22 5 9 25 14 24 10 6;
                25 5 10 25 13 23 10 6;
                25 5 10 24 13 22 9 6;
                23 4 9 22 12 19 8 5;
                21 4 8 20 12 18 7 4;
                12 2 3 8 5 7 2 1;
                2 0 0 1 1 1 0 0;
                0 0 0 0 0 0 0 0
        ]
    else
        error("no state set")
    end
    rng = MersenneTwister(279*sim)

    if p.scenario == :statuscuo
        v = abs.(v)
    elseif p.scenario == :fast
        v = abs.(v)
        v = Int.(round.(p.α.*v))
    elseif p.scenario == :half
        v = Int.(round.(abs.(v/2)))
    else
        v = [0 0 0 0 0 0 0 0;
        0 0 0 0 0 0 0 0]
    end

    rp = Int.(round.(mean(v[end-30:end,:],dims=1)))
    l2 = p.modeltime-(p.day_inital_vac+size(v,1)-2)
    if l2 > 0
        v2 = repeat(rp,l2)
        v2 = Int.(p.α3.*v2)
    
        for i = 1:l2
            aux = sum(v2[i,:])
            aux = Int(round(p.α2*aux))
            aux_v = sample(rng,1:size(v2,2),aux)
    
            for j in aux_v
                v2[i,j] = v2[i,j] + 1
            end
        end
        v = [v;v2]
    end

    

    return v
end

function vaccination_rate_2(sim::Int64)
    
    
    if p.prov == :usa
        v = [0 0 0 0 0 0 0 0;
                0 0 0 0 0 0 0 0;
                0 0 0 0 0 0 0 0;
                0 0 0 0 0 0 0 0;
                0 0 0 0 0 0 0 0;
                0 0 0 0 0 0 0 0;
                0 0 0 0 0 0 0 0;
                0 0 0 0 0 0 0 0;
                0 0 0 0 0 0 0 0;
                0 0 0 0 0 0 0 0;
                0 0 0 0 0 0 0 0;
                0 0 0 0 0 0 0 0;
                0 0 0 0 0 0 0 0;
                0 0 0 0 0 0 0 0;
                0 0 0 0 0 0 0 0;
                0 0 0 0 0 0 0 0;
                0 0 0 0 0 0 0 0;
                0 0 0 0 0 0 0 0;
                0 0 0 0 0 1 0 0;
                0 0 0 0 0 0 0 0;
                0 0 0 0 0 1 0 0;
                0 0 0 0 0 0 0 0;
                0 0 0 0 0 0 0 0;
                0 0 0 5 3 4 1 0;
                0 0 1 9 6 8 2 1;
                0 0 2 18 12 15 4 1;
                0 0 3 30 19 25 5 2;
                0 0 4 39 25 33 7 2;
                0 0 2 14 9 11 2 1;
                0 0 1 8 4 6 1 0;
                0 0 4 33 21 29 7 3;
                0 0 4 31 20 28 7 4;
                0 0 3 26 17 24 6 4;
                0 0 2 13 8 12 4 2;
                0 0 2 11 7 10 3 2;
                0 0 1 6 4 6 3 2;
                0 0 1 4 2 3 2 1;
                0 0 3 18 12 20 7 8;
                0 0 4 29 20 31 11 11;
                0 0 6 34 24 37 12 13;
                0 0 4 23 15 24 9 8;
                0 0 3 18 12 18 7 5;
                0 0 2 11 8 12 6 7;
                0 0 1 6 4 6 4 5;
                0 0 7 37 26 42 17 18;
                0 0 8 41 30 49 23 24;
                0 0 9 45 33 53 26 28;
                0 0 7 37 27 43 24 29;
                0 0 7 35 24 38 20 25;
                0 0 3 14 9 15 13 17;
                0 0 2 6 4 7 8 11;
                0 0 7 31 23 38 30 40;
                0 0 9 39 29 48 37 47;
                0 0 11 47 35 58 46 54;
                0 0 11 49 37 62 52 63;
                0 0 13 56 40 68 52 60;
                0 0 5 21 14 24 30 33;
                0 0 2 8 5 9 10 13;
                0 0 8 33 25 42 44 57;
                0 0 10 40 30 52 61 74;
                0 0 11 45 34 59 71 88;
                0 0 11 46 35 60 77 96;
                0 0 12 51 39 66 84 96;
                0 0 5 20 15 27 50 54;
                0 0 2 7 5 10 22 22;
                0 0 5 17 13 24 45 55;
                0 0 7 27 20 37 65 77;
                0 0 9 33 25 46 80 102;
                0 0 8 31 24 44 82 101;
                0 0 10 39 30 53 91 105;
                0 0 5 21 16 31 60 68;
                0 0 2 9 7 14 31 32;
                0 0 6 23 19 37 71 81;
                0 0 8 29 23 46 95 102;
                0 0 9 34 28 57 117 119;
                0 0 10 38 31 63 127 128;
                0 0 11 46 36 68 128 122;
                0 1 6 22 17 36 82 78;
                0 0 2 8 6 13 32 26;
                0 0 5 20 17 36 83 72;
                0 0 6 24 20 42 104 88;
                0 1 7 29 24 52 120 103;
                0 0 9 34 28 61 132 105;
                0 1 11 42 34 75 130 96;
                0 0 7 29 24 54 84 58;
                0 0 3 12 10 22 34 21;
                0 0 7 25 21 54 87 59;
                0 0 8 32 27 65 113 77;
                0 1 11 38 33 77 132 89;
                0 0 12 45 38 86 143 94;
                0 1 15 53 44 96 156 93;
                0 0 9 34 29 68 105 59;
                0 0 4 16 13 29 42 23;
                0 0 7 27 22 54 95 54;
                0 1 9 32 26 64 116 65;
                0 1 10 35 29 71 124 68;
                0 1 11 40 33 81 129 68;
                0 1 13 47 39 88 116 61;
                0 1 9 34 29 66 77 39;
                0 0 5 16 13 29 32 17;
                0 1 8 29 25 60 78 39;
                0 1 11 43 36 88 110 53;
                0 1 14 52 44 109 136 67;
                0 1 17 62 51 128 157 75;
                0 1 21 75 62 147 158 74;
                0 1 14 50 41 101 95 44;
                0 1 8 26 21 48 42 18;
                0 1 15 52 44 110 109 49;
                0 2 20 68 57 149 135 63;
                0 2 27 86 72 180 144 67;
                0 2 33 104 87 220 152 70;
                0 2 29 92 74 182 112 51;
                0 2 21 65 51 117 64 28;
                0 1 8 23 17 37 17 8;
                0 2 27 84 67 168 88 41;
                0 3 38 111 87 223 107 51;
                0 4 48 129 101 249 108 52;
                0 4 55 143 112 271 112 53;
                0 4 56 148 115 263 95 45;
                0 4 40 107 82 178 56 26;
                0 2 22 56 42 82 24 11;
                0 4 39 103 83 194 62 29;
                0 4 32 94 80 206 65 30;
                0 6 38 107 91 230 68 31;
                0 5 40 111 92 231 69 32;
                0 6 42 118 97 224 59 28;
                0 6 27 74 59 136 34 15;
                0 3 14 39 31 66 13 6;
                0 6 34 91 75 168 41 19;
                0 8 44 117 97 206 50 24;
                0 11 53 136 108 225 52 24;
                0 11 56 137 109 225 50 24;
                0 11 51 132 105 203 43 20;
                0 9 33 88 67 123 23 10;
                0 4 15 40 28 48 8 4;
                0 11 44 107 77 141 30 14;
                0 13 58 134 96 174 39 19;
                0 17 69 151 106 182 41 20;
                0 18 70 154 107 182 39 19;
                0 19 69 149 101 164 33 16;
                0 18 44 97 64 97 17 8;
                0 10 24 52 32 45 8 3;
                0 15 54 116 76 119 26 12;
                0 20 70 147 95 146 31 15;
                0 23 74 151 96 145 32 16;
                0 23 76 154 98 140 31 16;
                0 25 75 154 99 136 28 14;
                0 22 46 94 60 80 15 7;
                0 10 20 40 24 30 5 2;
                0 17 50 100 63 88 20 10;
                0 20 63 123 77 108 25 13;
                0 24 62 121 77 105 25 13;
                0 20 61 120 77 102 24 12;
                0 23 60 124 80 104 23 11;
                0 22 42 86 55 69 14 6;
                0 13 22 43 27 32 6 3;
                0 16 44 86 55 72 17 9;
                0 17 50 99 63 84 21 11;
                0 19 52 100 64 84 21 11;
                0 17 50 100 64 85 21 11;
                0 19 49 105 67 88 20 10;
                0 16 33 67 43 54 11 5;
                0 7 16 31 20 23 4 2;
                0 10 33 65 40 54 14 7;
                0 11 37 71 45 61 16 8;
                0 13 37 71 44 59 16 8;
                0 11 34 67 42 57 16 8;
                0 12 32 67 43 57 14 7;
                0 8 18 36 23 30 6 3;
                0 4 10 18 11 14 3 1;
                0 2 6 10 6 8 2 1;
                0 15 35 65 39 54 15 8;
                0 21 29 54 33 44 13 7;
                2 77 27 50 31 42 12 7;
                2 95 28 58 35 46 12 6;
                3 98 20 38 24 30 6 3;
                1 50 10 18 11 13 3 1;
                2 79 24 42 25 32 9 5;
                2 81 28 48 28 37 11 6;
                2 85 28 47 28 36 11 6;
                2 78 28 49 29 38 11 6;
                2 77 28 55 34 42 11 5;
                2 69 21 38 24 28 6 3;
                1 27 11 20 12 13 3 1;
                1 49 24 42 25 30 8 4;
                1 48 27 46 26 33 9 5;
                1 51 24 42 24 31 9 5;
                1 43 23 41 23 30 9 5;
                1 43 22 42 25 31 8 4;
                1 28 14 26 16 19 4 2;
                0 12 7 13 8 9 2 1;
                0 15 12 22 13 17 5 2;
                1 31 20 33 19 24 7 4;
                1 31 18 30 18 22 7 4;
                1 28 17 30 17 22 6 3;
                1 30 17 33 19 24 6 3;
                1 22 11 21 13 15 3 1;
                0 10 6 11 7 7 1 1;
                1 23 12 21 12 15 4 2;
                1 24 15 25 14 18 5 3;
                1 24 15 25 14 18 5 3;
                0 22 14 23 13 17 5 3;
                0 22 13 25 15 19 5 3;
                0 12 7 14 9 11 2 1;
                0 1 1 2 1 2 0 0;
                0 13 9 15 9 11 3 1;
                0 22 14 24 14 17 5 3;
                0 21 14 23 13 16 5 3;
                0 19 13 23 13 16 5 3;
                0 20 14 26 15 19 5 3;
                0 13 8 15 9 11 3 1;
                0 6 5 9 5 6 1 0;
                0 17 12 20 11 14 4 2;
                0 17 12 20 11 14 4 2;
                0 17 12 19 11 14 4 3;
                0 17 12 19 11 14 4 2;
                0 17 12 23 13 17 5 2;
                0 11 8 14 9 10 2 1;
                0 7 5 8 5 5 1 0;
                0 16 11 18 10 13 4 2;
                0 15 12 18 10 14 4 2;
                0 16 12 19 11 14 5 2;
                0 15 11 18 11 14 5 2;
                0 15 12 21 13 17 5 2;
                0 10 7 13 8 10 2 1;
                0 3 3 5 3 4 1 0;
                0 12 10 16 9 12 4 2;
                0 14 12 18 11 13 4 2;
                0 14 12 19 11 14 4 2;
                0 14 11 18 11 14 4 2;
                0 16 12 21 13 17 5 2;
                0 11 7 13 8 10 2 1;
                0 6 4 7 4 5 1 0;
                0 15 11 17 10 13 4 2;
                0 16 11 18 11 13 4 2;
                0 16 11 18 11 14 4 2;
                0 16 11 19 11 15 5 2;
                0 19 12 22 14 18 5 2;
                0 12 7 14 9 11 2 1;
                0 8 5 9 5 6 1 1;
                0 19 12 20 12 16 5 2;
                0 19 12 21 12 16 5 3;
                0 19 12 21 12 16 5 3;
                0 19 12 22 13 18 6 3;
                0 25 14 28 18 23 6 3;
                0 17 8 17 11 14 3 1;
                0 11 6 12 8 9 2 1;
                0 21 14 26 16 20 6 3;
                0 21 14 26 16 21 7 3;
                0 22 15 28 17 21 7 4;
                0 21 14 28 17 22 7 4;
                0 29 16 35 22 28 8 4;
                0 21 10 21 14 16 4 2;
                0 12 7 14 9 9 2 1;
                0 23 15 31 19 23 7 3;
                0 24 15 32 18 23 7 4;
                0 24 15 33 19 23 7 4;
                0 24 16 33 20 24 8 4;
                0 32 18 41 25 31 8 4;
                0 25 12 25 16 18 4 2;
                0 14 8 17 10 10 2 1;
                0 24 15 34 20 23 7 3;
                0 23 15 33 19 23 7 4;
                0 22 15 33 18 22 7 4;
                0 21 15 32 18 22 7 4;
                0 30 17 38 22 26 7 4;
                0 20 10 21 13 14 3 1;
                0 11 7 14 8 8 2 1;
                0 5 3 7 4 5 1 1;
                0 25 18 40 22 26 8 4;
                0 20 16 34 18 21 6 3;
                0 18 15 34 18 22 7 3;
                0 27 18 42 24 27 7 3;
                0 21 11 24 14 15 3 1;
                0 10 7 15 8 8 2 1;
                0 16 15 35 18 21 6 3;
                0 15 15 34 18 21 6 3;
                0 16 16 35 18 21 6 3;
                0 16 16 35 18 22 6 3;
                0 22 19 42 23 27 7 3;
                0 17 11 23 13 14 3 1;
                0 9 7 15 8 8 2 1;
                0 13 15 32 17 19 6 3;
                0 13 14 31 16 18 6 3;
                0 13 15 31 15 18 5 3;
                0 12 15 30 15 17 5 3;
                0 19 17 36 19 22 7 3;
                0 14 9 19 10 11 4 2;
                0 8 6 13 6 7 2 1;
                0 7 9 19 10 12 6 4;
                0 10 12 27 13 16 7 4;
                0 10 13 28 14 16 7 4;
                0 10 14 29 14 17 7 4;
                0 14 15 34 17 20 7 4;
                0 11 8 18 10 11 3 2;
                0 6 5 12 6 6 2 1;
                0 9 11 24 12 13 6 3;
                0 8 11 23 11 13 6 4;
                0 8 11 24 11 13 6 4;
                0 8 11 23 11 13 6 3;
                0 12 12 28 14 17 6 3;
                0 9 6 15 8 9 3 1;
                0 5 4 10 5 5 1 1;
                0 7 9 20 10 12 5 3;
                0 7 10 22 10 12 5 3;
                0 7 10 21 10 12 5 3;
                0 7 10 21 10 12 5 3;
                0 10 11 25 13 15 5 3;
                0 7 6 13 7 8 2 1;
                0 4 4 8 4 4 1 1;
                0 6 9 20 10 11 4 3;
                0 6 8 18 9 10 4 3;
                0 6 8 18 9 10 4 3;
                0 6 8 18 9 11 4 3;
                0 8 9 21 11 14 6 4;
                0 6 5 11 6 7 4 2;
                0 3 3 7 4 4 2 1;
                0 5 7 17 9 11 7 5;
                0 5 7 17 8 11 7 5;
                0 5 7 17 9 11 7 5;
                0 5 7 17 9 12 7 5;
                0 7 7 20 11 14 7 5;
                0 4 4 10 5 7 3 2;
                0 2 3 6 3 4 2 1;
                0 5 7 16 8 11 6 4;
                0 4 6 16 8 10 6 5;
                0 4 7 16 8 11 6 5;
                0 5 7 16 8 11 6 5;
                0 7 7 20 11 14 6 4;
                0 4 4 10 5 7 3 2;
                0 2 3 7 3 4 1 1;
                0 4 6 15 8 10 5 3;
                0 4 6 14 7 9 5 4;
                0 4 6 14 7 10 5 4;
                0 4 5 13 7 9 5 3;
                0 6 6 17 9 12 5 4;
                0 4 3 9 5 6 2 1;
                0 2 2 5 3 3 1 1;
                0 4 6 14 7 10 5 3;
                0 4 6 14 7 10 5 4;
                0 4 6 14 7 10 5 4;
                0 4 6 14 8 10 5 4;
                0 5 6 16 9 12 5 3;
                0 3 3 8 5 7 2 1;
                0 1 2 5 3 4 1 1;
                1 4 6 14 8 11 5 3;
                1 4 6 14 7 10 4 3;
                5 4 5 12 6 8 3 2;
                0 0 0 0 0 0 0 0;
                14 4 4 10 6 8 3 1;
                32 3 3 7 4 5 2 1;
                25 2 2 5 2 3 1 1;
                55 5 6 13 7 10 4 3;
                61 5 6 14 7 11 5 3;
                65 5 6 14 7 11 5 3;
                60 5 5 13 7 11 5 3;
                79 7 6 15 9 13 5 3;
                93 5 3 8 5 6 2 1;
                35 3 2 5 3 4 1 1;
                45 5 5 12 7 10 4 2;
                47 5 5 12 7 9 4 2;
                48 5 5 12 6 9 4 2;
                42 4 5 11 6 8 3 2;
                45 5 4 10 6 8 3 2;
                36 3 1 3 2 3 1 0;
                2 0 0 0 0 0 0 0;
                0 0 0 0 0 0 0 0
        ]
    else
        error("no state set")
    end

    rng = MersenneTwister(279*sim)
    if p.scenario == :statuscuo
        v = abs.(v)
    elseif p.scenario == :fast
        v = abs.(v)
        v = Int.(round.(p.α.*v))
    elseif p.scenario == :half
        v = Int.(round.(abs.(v/2)))
    else
        v = [0 0 0 0 0 0 0 0;
        0 0 0 0 0 0 0 0]
    end

    
    rp = Int.(round.(mean(v[end-30:end,:],dims=1)))
    l2 = p.modeltime-(p.day_inital_vac+size(v,1)-2)
    if l2 > 0
        v2 = repeat(rp,l2)
        v2 = Int.(p.α3.*v2)
    
        for i = 1:l2
            aux = sum(v2[i,:])
            aux = Int(round(p.α2*aux))
            aux_v = sample(rng,1:size(v2,2),aux)
    
            for j in aux_v
                v2[i,j] = v2[i,j] + 1
            end
        end
        v = [v;v2]
    end

    

    return v
end





function temporal_proportion()
    
    if p.prov == :usa
        v = [1]
        fd = [0.561 0.369 0.07]
        sd = [0.561 0.369 0.0]
    else
        error("no distribution for proportion")
    end

    if !p.using_jj
        sd[:,3] .= 0
        fd[:,3] .= 0
        
    end

    return v,fd,sd
end


function get_breaks_vac()

    if p.prov == :usa
        brak = @SVector [5:11,12:17, 18:24, 25:39, 40:49, 50:64, 65:74, 75:100]
    else
        #brak = @SVector [12:15, 16:17, 18:24, 25:39, 40:49, 50:64, 65:74, 75:100]
        error("no age breaks vac")
    end
    return brak
end


function waning_factor()
    M = [1	1	1	1;
            0.9985	0.9972	1	1;
            0.9951	0.9934	1	1;
            0.9897	0.9885	1	1;
            0.9824	0.9825	1	1;
            0.9733	0.9756	1	1;
            0.9623	0.9676	1	1;
            0.9496	0.9587	1	1;
            0.9352	0.9488	0.9993	1;
            0.9192	0.9381	0.9963	1;
            0.9016	0.9264	0.991	1;
            0.8827	0.9139	0.9835	0.9989;
            0.8625	0.9006	0.9737	0.9961;
            0.8411	0.8866	0.9619	0.9917;
            0.8186	0.8718	0.948	0.9856;
            0.7951	0.8563	0.9321	0.9779;
            0.7708	0.8402	0.9145	0.9686;
            0.7457	0.8235	0.895	0.9578;
            0.7201	0.8063	0.874	0.9454;
            0.6939	0.7886	0.8515	0.9316;
            0.6674	0.7705	0.8277	0.9164;
            0.6406	0.7519	0.8027	0.8999;
            0.6137	0.733	0.7766	0.8822;
            0.5868	0.7138	0.7497	0.8633;
            0.5599	0.6944	0.722	0.8434;
            0.5332	0.6747	0.6938	0.8226;
            0.5068	0.655	0.6651	0.8009;
            0.4808	0.6351	0.6361	0.7785;
            0.4551	0.6151	0.607	0.7555;
            0.43	0.5951	0.5779	0.7319;
            0.4055	0.5752	0.549	0.708;
            0.3816	0.5553	0.5202	0.6837;
            0.3585	0.5356	0.4919	0.6591;
            0.336	0.5159	0.464	0.6345;
            0.3144	0.4965	0.4367	0.6098;
            0.2936	0.4773	0.41	0.5852;
            0.2736	0.4583	0.3841	0.5607;
            0.2544	0.4396	0.359	0.5365;
            0.2362	0.4213	0.3348	0.5125;
            0.2188	0.4032	0.3115	0.4889;
            0.2023	0.3855	0.2891	0.4658;
            0.1867	0.3682	0.2677	0.4431;
            0.1719	0.3513	0.2474	0.4209;
            0.158	0.3348	0.228	0.3993;
            0.1449	0.3187	0.2097	0.3783;
            0.1327	0.3031	0.1924	0.358;
            0.1212	0.2879	0.1762	0.3383;
            0.1105	0.2732	0.1609	0.3193;
            0.1006	0.259	0.1466	0.301;
            0.0914	0.2452	0.1333	0.2835;
            0.0828	0.2319	0.1209	0.2666;
            0.0749	0.2192	0.1094	0.2504;
            0.0677	0.2068	0.0988	0.235;
            0.061	0.195	0.089	0.2203;
            0.0548	0.1837	0.08	0.2062;
            0.0492	0.1728	0.0717	0.1929;
            0.0441	0.1624	0.0642	0.1802;
            0.0394	0.1524	0.0573	0.1682;
            0.0352	0.1429	0.051	0.1569;
            0.0313	0.1339	0.0453	0.1461;
            0.0278	0.1253	0.0402	0.136;
            0.0247	0.1171	0.0355	0.1264;
            0.0219	0.1093	0.0313	0.1174;
            0.0193	0.102	0.0276	0.109;
            0.017	0.095	0.0242	0.101;
            0.015	0.0884	0.0212	0.0936;
            0.0132	0.0822	0.0186	0.0866;
            0.0115	0.0763	0.0162	0.0801;
            0.0101	0.0708	0.0141	0.074;
            0.0088	0.0656	0.0122	0.0683;
            0.0077	0.0607	0.0106	0.063;
            0.0067	0.0562	0.0092	0.058;
            0.0058	0.0519	0.0079	0.0534;
            0.005	0.0479	0.0068	0.0491;
            0.0043	0.0441	0.0058	0.0451;
            0.0037	0.0406	0.005	0.0414;
            0.0032	0.0374	0.0043	0.038;
            0.0028	0.0343	0.0036	0.0348;
            0.0024	0.0315	0.0031	0.0319;
            0.002	0.0289	0.0026	0.0292;
            0.0017	0.0264	0.0022	0.0266;
            0.0015	0.0242	0.0019	0.0243;
            0.0013	0.0221	0.0016	0.0222;
            0.0011	0.0202	0.0013	0.0202;
            0.0009	0.0184	0.0011	0.0184;
            0.0008	0.0168	0.0009	0.0167;
            0.0006	0.0152	0.0008	0.0152;
            0.0005	0.0139	0.0006	0.0138;
            0.0005	0.0126	0.0005	0.0125;
            0.0004	0.0114	0.0004	0.0114;
            0.0003	0.0103	0.0004	0.0103;
            0.0003	0.0093	0.0003	0.0093;
            0.0002	0.0085	0.0003	0.0084;
            0.0002	0.0076	0.0002	0.0076;
            0.0002	0.0069	0.0002	0.0068;
            0.0001	0.0062	0.0001	0.0062;
            0.0001	0.0056	0.0001	0.0055;
            0.0001	0.005	0.0001	0.005;
            0.0001	0.0045	0.0001	0.0045;
            0.0001	0.004	0.0001	0.004]

    return M
end


function booster_doses()

    if p.prov == :usa
        v = [0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                4
                10
                9
                23
                29
                34
                33
                35
                18
                9
                28
                29
                30
                32
                36
                18
                10
                29
                31
                34
                33
                34
                13
                8
                3
                27
                28
                28
                31
                14
                6
                22
                21
                22
                22
                26
                14
                7
                24
                25
                24
                29
                75
                69
                41
                147
                155
                156
                160
                172
                72
                37
                137
                148
                151
                146
                159
                64
                33
                117
                133
                129
                132
                147
                60
                29
                115
                123
                126
                130
                239
                148
                81
                289
                301
                315
                313
                346
                152
                75
                272
                292
                299
                309
                347
                150
                73
                231
                266
                286
                251
                322
                150
                78
                258
                287
                301
                309
                360
                188
                107
                324
                318
                231
                3
                202
                132
                84
                264
                312
                349
                361
                395
                197
                102
                299
                310
                300
                282
                268
                87
                7
                0
        ]
    end

    rp = Int.(round.(mean(v[end-30:end])))
    l2 = p.modeltime-(p.day_inital_vac+length(v)-2)
    if l2 > 0
        v2 = repeat([rp],l2)
        v = [v;v2]
    end
    return v
end

function vector_probs()
    if p.prov == :usa
        v = [
                0.00603544115854269
                0.0115650479359956
                0.0189439772708664
                0.0266462899330853
                0.0341911289750303
                0.0416875018712398
                0.0481688977359363
                0.0548522634434419
                0.0602005770614198
                0.0676484838118938
                0.0757585406694647
                0.0833723571270129
                0.0904872865690716
                0.0976386069737987
                0.103845416483816
                0.110815443729068
                0.119209019268518
                0.129047316025902
                0.137989733447777
                0.146968045591921
                0.155794011933258
                0.163597061396682
                0.171616306261049
                0.180753746160133
                0.190869937541529
                0.200383527663831
                0.209270035333971
                0.218127761060909
                0.225982254112468
                0.234384265738719
                0.243784382222882
                0.255212467808472
                0.266617395508727
                0.277664037640165
                0.288104274002776
                0.297893608374024
                0.3068618302967
                0.317907479947339
                0.330069505084562
                0.341649440232558
                0.353185209984952
                0.363982904849046
                0.373889186541233
                0.38419031017837
                0.394520546585643
                0.406252165882579
                0.418771814934752
                0.430076502074202
                0.440927956314965
                0.451111967217698
                0.460673692658801
                0.470717763768727
                0.48200342835951
                0.491909875465163
                0.50174453312628
                0.510690755057889
                0.518517458647047
                0.525922523309652
                0.534194189124164
                0.543648230398463
                0.552838437193417
                0.561104975190461
                0.569109167429361
                0.575642337709126
                0.582177492950492
                0.589174317177345
                0.596705261488089
                0.603515830151467
                0.609634308870281
                0.615433705011879
                0.620473191687576
                0.624836633524976
                0.630133999795218
                0.635234689453585
                0.639876025914997
                0.644119708402524
                0.648236022520713
                0.651563645229798
                0.654728004847276
                0.658918589612001
                0.663135475117927
                0.666973398371703
                0.670753426912142
                0.673864027152951
                0.676875710140689
                0.679955047236297
                0.683679496851934
                0.688428352066684
                0.692003929562314
                0.695310048520732
                0.698749159906356
                0.702371218586122
                0.705784360057478
                0.709654538937255
                0.713715108717174
                0.717438896678944
                0.720539406698286
                0.723665059564562
                0.72682445677804
                0.730137853928992
                0.733821281004893
                0.737757956098273
                0.742014540836201
                0.745830629512376
                0.749300507802801
                0.7529109875399
                0.756056159195244
                0.759969676403289
                0.764309629528421
                0.768769507416892
                0.772267175169718
                0.775955895476554
                0.77887064617282
                0.782231351575241
                0.786344853664495
                0.790918205191105
                0.795628849895053
                0.799682472309372
                0.803604260190751
                0.807237070745851
                0.811560978764715
                0.816436375281472
                0.822055470744395
                0.827076927352225
                0.831469481959759
                0.835547089326746
                0.839384185513188
                0.843806514544723
                0.84949806110605
                0.855575517285128
                0.861162522535517
                0.865931558193202
                0.870151917381928
                0.874683419301469
                0.878874004066194
                0.883571415692809
                0.888783428614247
                0.89401264453622
                0.898980507180847
                0.903395558019849
                0.907658097642577
                0.912147915368516
                0.917394830531422
                0.922931715501409
                0.928671397381538
                0.933934853891112
                0.938953002229608
                0.944066924965309
                0.948304156327636
                0.954110003594435
                0.959455836010412
                0.964371427999571
                0.968826012657108
                0.972879635071426
                0.976430896787455
                0.979494354190262
                0.982978954279222
                0.985845569656686
                0.988657267763215
                0.991077928434525
                0.992803687132338
                0.994529280416683
                0.995942738489414
                0.997020572638264
                0.997950030907506
                0.99861879755327
                0.999023068065822
                0.999254481505699
                0.999404511519973
                0.999520631773578
                0.999632120450117
                0.999724090337587
                0.99979108279159
                0.999831609090926
                0.999876270726928
                0.999909518833729
                0.999929203036263
                0.999948556411864
                0.999962285729598
                0.999973368431865
                0.999979323316666
                0.999982796999466
                0.999985443614933
                0.999988421057333
                0.999989248124666
                0.999990075192
                0.999990075192
                0.999992556394
                0.999992887220933
                0.999995037596
                0.999995037596
                0.999995037596
                0.9999955338364
                0.999995864663333
                0.999995864663333
                0.999995864663333
                0.999997518798
                0.999997518798
                0.999997518798
                0.999997518798
                0.999997684211467
                0.999997849624933
                0.999997849624933
                0.9999980150384
                0.9999980150384
                0.9999980150384
                0.9999980150384
                0.9999980150384
                0.999998180451867
                0.999998180451867
                0.999998180451867
                0.999998676692267
                0.999998842105733
                0.9999990075192
                0.999999172932667
                0.999999172932667
                0.999999172932667
                0.999999172932667
                0.9999995037596
                0.999999669173067
                0.999999834586533
                0.999999834586533
                0.999999834586533
                1
        ]
    end

    return v
end